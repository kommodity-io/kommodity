providers:
  # Only used for development and testing purposes with KOMMODITY_DEVELOPMENT_MODE=true
  - name: local
    provider: docker
    development_mode: true
    repository: kubernetes-sigs/cluster-api
    go_module: sigs.k8s.io/cluster-api
    file_name: infrastructure-components-development.yaml
    filter: select(.kind == "CustomResourceDefinition")
    scheme_locations:
      - test/infrastructure/docker/api/v1beta1
    deny_list:
      - DevCluster
      - DevClusterTemplate
      - DevMachine
      - DevMachineTemplate
  - name: capi
    provider: capi
    repository: kubernetes-sigs/cluster-api
    go_module: sigs.k8s.io/cluster-api
    file_name: core-components.yaml
    filter: select(.kind == "CustomResourceDefinition")
    scheme_locations:
      - api/v1beta1
      - api/addons/v1beta1
      - exp/api/v1beta1
      - exp/runtime/api/v1alpha1
    webhooks:
      - config/webhook/manifests.yaml
  - name: cabpt
    provider: talos
    repository: siderolabs/cluster-api-bootstrap-provider-talos
    file_name: bootstrap-components.yaml
    filter: select(.kind == "CustomResourceDefinition")
    scheme_locations:
      - api/v1alpha2
      - api/v1alpha3
    webhooks:
      - config/webhook/manifests.yaml
  - name: cacppt
    provider: talos
    repository: siderolabs/cluster-api-control-plane-provider-talos
    file_name: control-plane-components.yaml
    filter: select(.kind == "CustomResourceDefinition")
    scheme_locations:
      - api/v1alpha3
    webhooks:
      - config/webhook/manifests.yaml
  - name: scw
    provider: scaleway
    repository: scaleway/cluster-api-provider-scaleway
    file_name: infrastructure-components.yaml
    filter: select(.kind == "CustomResourceDefinition")
    deny_list:
      - ScalewayManagedCluster
      - ScalewayManagedControlPlane
      - ScalewayManagedMachinePool
    scheme_locations:
      - api/v1alpha1
  - name: capz
    provider: azure
    repository: kubernetes-sigs/cluster-api-provider-azure
    go_module: sigs.k8s.io/cluster-api-provider-azure
    file_name: infrastructure-components.yaml
    # We only want to include Kinds of type CustomResourceDefinition with at least one .spec.version which is not deprecated.
    # Managed resources and AzureCluster kinds are not needed
    filter: select(.kind == "CustomResourceDefinition") | select([.spec.versions[] | select(.deprecated != true)] | length > 0) | .spec.versions |= map(select(.deprecated != true))
    deny_list:
      - AzureASOManagedCluster
      - AzureASOManagedClusterTemplate
      - AzureASOManagedControlPlane
      - AzureASOManagedControlPlaneTemplate
      - AzureASOManagedMachinePool
      - AzureASOManagedMachinePoolTemplate
      - BastionHost
      - FleetsMember
      - ManagedCluster
      - ManagedClustersAgentPool
    scheme_locations:
      - api/v1alpha1
      - api/v1beta1
      - exp/api/v1beta1
  - name: kubevirt
    provider: kubevirt
    repository: kubernetes-sigs/cluster-api-provider-kubevirt
    go_module: sigs.k8s.io/cluster-api-provider-kubevirt
    file_name: infrastructure-components.yaml
    filter: select(.kind == "CustomResourceDefinition")
    scheme_locations:
      - api/v1alpha1
